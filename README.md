# TimeCapture

> A REST API designed to provide microservices for employee time management. Functioning as a punch clock, it keeps track of employees and their associated punches and generates hours worked based off of this information.


## Built With

- Java
- Spring Boot | Spring Security
- Gradle | MySQL | Docker | Swagger


## Getting Started

To get a local copy up and running follow these simple steps!


### Prerequisites

- Java 8+
- MySQL server


### Setup

A database is required for data persistence. The application is configured to work with a MySQL database, but could easily be made to work with others (re-configurations can be made in the `build.gradle` and `application.properties` files).

I have included a SQL script that can be used to create the database and insert a single employee record with administrative access.  
`TimeCapture/src/main/resources/database/init.sql`

I have also included an EER diagram as a visual representation of the database.  
`TimeCapture/src/main/resources/database/EER.png`


### Install

Once the database is up and running on a MySQL server you are ready to install!

First clone the repository to a directory on your local machine.
```
git clone https://github.com/ghorned/TimeCapture
```

Next, open the project's `application.properties` file in an editor of your choice. Nano for example:
```
nano TimeCapture/src/main/resources/application.properties
```  
There are several properties in this file that need to be configured in order to connect to the database you just built. They are the fields: `<database location>`, `<port number>`, `<database name>`, `<database username>`, and `<database password>`.


### Build

Once you have updated the `application.properties` file with your new database's information, you are ready to build and run the application!

First, make sure you are at the project directory's root level, then build the application using the Gradle wrapper:
```
./gradlew clean build // For Unix based machines

gradlew.bat clean build // For Windows
```


### Run

Now that the project is built, there are several options for running the application depending upon how you want to use it.

#### Run using Gradle wrapper

The most straightforward way to run the application is to use the Gradle wrapper.
```
./gradlew bootrun // For Unix based machines

gradlew.bat bootrun // For Windows
```

#### Run using fat jar

Alternatively, building the project also generates a fat jar file that can be used for launching the application.
```
java -jar build/libs/TimeCapture-0.0.1-SNAPSHOT.jar
```

#### Run using Docker

The final option is to build the project as a Docker image...
```
./gradlew docker // To build the Docker image on Unix based machines

gradlew.bat docker // To Build the Docker image on Windows
```
...and then to run the image in a docker container
```
./gradlew dockerRun // To Run the image in a container on Unix based machines

gradlew.bat dockerRun // To run the imae in a container on Windows
```
Done! You are now ready to start using the application.


### Usage

#### Security

The application utilizes Spring Security for basic authentication and role-based authorization. There are two levels of access: ADMIN and USER. Each employee record will contain a field (accessAuthority) representing their assigned role. A caller with ADMIN authority can access any endpoint, whereas a USER can only access certain information related to themselves.

If you initialized the database with the script I provided you should already have an employee record with ADMIN level access. All that is necessary is to provide that employee's credentials in the request header.

`username: JSmith`

`password: testPassword`

Additional employees can be added either directly to the database or through the API. Note that the application uses BCrypt (10 rounds) to encrypt stored passwords. Passwords are automatically encrypted when passed via the API, but not when they are inserted directly into the database. Therefore, it is suggested that additional employees be added via the API using the starter credentials listed above.

#### Documentation
Documentation is generated by running the application and can be found at `http://localhost:8080/api-docs.html`.